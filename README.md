## –û–ø–∏—Å–∞–Ω–∏–µ

**Smart Notification Service** ‚Äî —ç—Ç–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞ –±–∞–∑–µ **FastAPI**, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ Email –∏ Telegram.  
–°–µ—Ä–≤–∏—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞—è–≤–∫–∏ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`, –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—É –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ —Å –∏–º–∏—Ç–∞—Ü–∏–µ–π –∑–∞–¥–µ—Ä–∂–∫–∏.

–ü—Ä–æ–µ–∫—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Å–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è:
- ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ `BackgroundTasks`
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Redis (–≤ –ø–∞–º—è—Ç–∏)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ —Å—Ç–∞—Ç—É—Å—É
- ‚úÖ Unit-—Ç–µ—Å—Ç—ã —Å `pytest`
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Docker –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker –∏ Docker Compose
- Python 3.11+ (–¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose

```bash
git clone https://github.com/Alex5200/notificationFastapi.git
cd notification-service
docker-compose up --build
```

–°–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:  
üëâ **http://localhost:8000**

Swagger UI (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API):  
üëâ **http://localhost:8000/docs**

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—â–µ–Ω–Ω—ã–π Redis –Ω–∞ localhost:6379)
uvicorn app.main:app --reload
```

---

## üì° API Endpoints

### 1. `POST /api/notifications` ‚Äî –°–æ–∑–¥–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "user_id": 123,
  "message": "–í–∞—à –∫–æ–¥: 1111",
  "type": "telegram"
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –í–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è |
|------|-----|---------------|---------------------|
| `user_id` | `int` | ‚úÖ | –õ—é–±–æ–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ |
| `message` | `str` | ‚úÖ | 1‚Äì1000 —Å–∏–º–≤–æ–ª–æ–≤ |
| `type` | `str` | ‚úÖ | `"email"` –∏–ª–∏ `"telegram"` |

**–û—Ç–≤–µ—Ç (201 Created):**
```json
{
  "message": "Notification processing started",
  "user_id": 123,
  "type": "telegram",
  "status": "accepted"
}
```


---

### 2. `GET /api/notifications/{user_id}` ‚Äî –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `status` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É (`pending`, `sent`, `failed`)

**–ü—Ä–∏–º–µ—Ä—ã:**
- –í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: `GET /api/notifications/123`
- –¢–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ: `GET /api/notifications/123?status=sent`

**–û—Ç–≤–µ—Ç (200 OK):**
```json
{
  "user_id": 123,
  "count": 2,
  "notifications": [
    {
      "user_id": 123,
      "message": "–í–∞—à –∫–æ–¥: 1111",
      "type": "telegram",
      "status": "sent",
      "created_at": "2026-01-07T10:00:00.000000",
      "sent_at": "2026-01-07T10:00:00.200000"
    },
    {
      "user_id": 123,
      "message": "–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏",
      "type": "email",
      "status": "pending",
      "created_at": "2026-01-07T10:01:00.000000",
      "sent_at": null
    }
  ]
}
```

---

## ‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **Redis** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
- –ö–ª—é—á: `notification:{user_id}:{timestamp}`
- –ó–Ω–∞—á–µ–Ω–∏–µ: —Ö–µ—à —Å –ø–æ–ª—è–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (`user_id`, `message`, `type`, `status`, `created_at`, `sent_at`)

### –§–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `BackgroundTasks` –∏–∑ FastAPI.
- –ü–æ—Å–ª–µ –ø—Ä–∏—ë–º–∞ –∑–∞—è–≤–∫–∏:
  1. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`.
  2. –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞.
  3. –ó–∞–¥–∞—á–∞ "—Å–ø–∏—Ç" (`asyncio.sleep`) –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `sent`.


---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
pytest
```

---

## üê≥ Docker –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –§–∞–π–ª—ã
- `Dockerfile` ‚Äî —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- `docker-compose.yml` ‚Äî –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞ –∏ Redis –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.
- `requirements.txt` ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞.

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `fastapi`
- `uvicorn`
- `pydantic`
- `redis`
- `pytest`
- `httpx`

---

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

| –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|
| FastAPI + Python 3.11+ | ‚úÖ |
| GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π | ‚úÖ |
| Dockerfile | ‚úÖ |
| Unit-—Ç–µ—Å—Ç—ã (pytest) | ‚úÖ (3 —Ç–µ—Å—Ç–∞) |
| –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ | ‚úÖ |
| –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É | ‚úÖ |
| Retry –º–µ—Ö–∞–Ω–∏–∑–º | ‚úÖ (–±–æ–Ω—É—Å) |
| Docker Compose —Å Redis | ‚úÖ |

